# =============================================================================
# SAML2 Single Sign-On (SSO) Configuration
# =============================================================================
# This file configures SAML2 authentication for NexusLIMS-CDCS.
# SAML2 allows users to authenticate using your organization's identity provider
# (e.g., Okta, Azure AD, Keycloak, ADFS).
#
# Setup workflow:
# 1. Configure your identity provider (IdP) to trust this CDCS service provider (SP)
# 2. Obtain the IdP metadata URL or file
# 3. Update the settings below to match your IdP configuration
# 4. Configure attribute mappings to map IdP user attributes to Django user fields
# 5. Test authentication flow
# =============================================================================

# Enable/disable SAML2 SSO authentication
# Set to True to enable SAML2 login alongside local authentication
# Set to False to disable SAML2 (only local username/password login)
ENABLE_SAML2_SSO_AUTH=True

# =============================================================================
# Identity Provider (IdP) Metadata Configuration
# =============================================================================
# SAML2 uses XML metadata to exchange configuration between IdP and SP.
# You can provide metadata via URL (recommended) or local file.

# Remote metadata URL - URL to your IdP's metadata XML
# Examples:
#   Keycloak: https://keycloak.example.com/auth/realms/your-realm/protocol/saml/descriptor
#   Okta: https://your-org.okta.com/app/abc123xyz/sso/saml/metadata
#   Azure AD: https://login.microsoftonline.com/your-tenant-id/federationmetadata/2007-06/federationmetadata.xml
SAML_METADATA_REMOTE=http://localhost:8080/auth/realms/cdcs-realm/protocol/saml/descriptor

# Certificate for validating remote metadata (if your IdP uses HTTPS with custom CA)
# Path is relative to saml2/ directory. Leave empty for public CAs.
SAML_METADATA_REMOTE_CERT=ca.crt

# Local metadata file - Alternative to remote URL
# Path is relative to saml2/ directory. Use this if your IdP can't be reached via URL.
SAML_METADATA_LOCAL=metadata.xml

# =============================================================================
# Attribute Mapping Configuration
# =============================================================================
# Maps SAML attributes from your IdP to Django user fields.
# Your IdP sends user attributes in SAML assertions. These settings tell Django
# how to interpret those attributes and populate user profiles.

# Directory containing attribute map files (relative to saml2/ directory)
SAML_ATTRIBUTE_MAP_DIR=attr-maps

# Attribute name format identifier
# Common values:
#   - urn:oasis:names:tc:SAML:2.0:attrname-format:basic (simple names like "email")
#   - urn:oasis:names:tc:SAML:2.0:attrname-format:uri (URN/OID format)
SAML_ATTRIBUTES_MAP_IDENTIFIER=urn:oasis:names:tc:SAML:2.0:attrname-format:basic

# Field names used by your IdP for user attributes
# These are the keys used in SAML assertions (check your IdP configuration)
SAML_ATTRIBUTES_MAP_UID_FIELD=uid          # Unique user identifier
SAML_ATTRIBUTES_MAP_EMAIL_FIELD=mail       # Email address
SAML_ATTRIBUTES_MAP_CN_FIELD=cn            # Common name (first name)
SAML_ATTRIBUTES_MAP_SN_FIELD=sn            # Surname (last name)

# OID/URN identifiers for each attribute (alternative to simple field names)
# Use these if your IdP uses OID format instead of simple names
SAML_ATTRIBUTES_MAP_UID=urn:oid:0.9.2342.19200300.100.1.1      # uid
SAML_ATTRIBUTES_MAP_EMAIL=urn:oid:1.2.840.113549.1.9.1         # emailAddress
SAML_ATTRIBUTES_MAP_CN=urn:oid:2.5.4.42                        # givenName
SAML_ATTRIBUTES_MAP_SN=urn:oid:2.5.4.4                         # surname

# =============================================================================
# Django User Creation Settings
# =============================================================================

# Django user attribute to use as the main identifier
# Usually "username" or "email"
SAML_DJANGO_USER_MAIN_ATTRIBUTE=username

# Use SAML NameID as username instead of mapped attributes
# Set to True if your IdP sends username in NameID element
# Set to False to use attribute mapping (recommended)
SAML_USE_NAME_ID_AS_USERNAME=False

# Auto-create Django users on first SAML login
# Set to True to automatically create accounts for new users
# Set to False to require admin pre-creation of accounts (more secure)
SAML_CREATE_UNKNOWN_USER=False

# =============================================================================
# Security Settings (Pysaml2)
# =============================================================================

# Path to xmlsec1 binary (used for XML signature verification)
# Usually /usr/bin/xmlsec1 on Linux systems
SAML_XMLSEC_BIN_PATH=/usr/bin/xmlsec1

# Require SAML responses to be signed (RECOMMENDED: True)
# Ensures authentication responses haven't been tampered with
SAML_WANT_RESPONSE_SIGNED=True

# Require SAML assertions to be signed (RECOMMENDED: True)
# Provides additional security by signing the assertion payload
SAML_WANT_ASSERTIONS_SIGNED=True

# Require logout requests to be signed (RECOMMENDED: True)
# Prevents unauthorized logout of users
SAML_LOGOUT_REQUESTS_SIGNED=True

# Service provider private key and certificate
# These are used to sign SAML requests and decrypt encrypted assertions
# Paths are relative to saml2/ directory
# Generate with: openssl req -new -x509 -days 3652 -nodes -out ca.cert -keyout my.key
SAML_KEY_FILE=my.key    # Private key (keep secure!)
SAML_CERT_FILE=ca.cert  # Public certificate (share with IdP)

# =============================================================================
# Service Provider (SP) Contact Information
# =============================================================================
# Contact persons for technical and administrative support
# Format: Firstname,Lastname,Organization,Email,Type
# Types: technical, administrative, support, billing, other

CONTACT_PERSON_1=Firstname1,Lastname1,Example Co.,contact1@example.com,technical
CONTACT_PERSON_2=Firstname2,Lastname2,Example Co.,contact2@example.com,administrative

# Organization information
# Format: Organization Name,Language Code (e.g., en, fr, de)
ORGANIZATION_NAME_1=Example Company,en
ORGANIZATION_NAME_2=Exempel AB,se
ORGANIZATION_DISPLAY_NAME_1=Exempel AB,se
ORGANIZATION_URL_1=http://example.com,en
ORGANIZATION_URL_2=http://exemple.se,se
